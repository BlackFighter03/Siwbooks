
<!DOCTYPE html>
<html lang="it" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Dettagli Libro</title>
    <link href="https://fonts.googleapis.com/css?family=Merriweather:400,700|Open+Sans:400,600" rel="stylesheet">
    <link rel="stylesheet" th:href="@{/css/book.css}">
</head>

<body>
    <header class="header">
        <nav class="navbar">
            <div class="navbar-content">
                <div class="navbar-links-group">
                    <h1 class="navbar-Title">SiwBooks</h1>
                </div>
				<div class="navbar-links-group">
					<a th:href="@{'/admin/' + ${user.id}}" class="navbar-link">Profilo</a>
					<a th:href="@{/admin/books}" class="navbar-link active">Libri</a>
					<a th:href="@{/admin/authors}" class="navbar-link">Autori</a>
		            <a th:href="@{/logout}" class="navbar-link">Esci</a>
		        </div>
            </div>
        </nav>
    </header>

    <div class="details-container">
        <div class="book-details">
            <!-- eventuale carousel immagini -->
			<div class="carousel-container" role="region" aria-label="Galleria immagini libro">
                <!-- Radio Inputs -->
                <th:block th:if="${not #lists.isEmpty(book.images)}">
                    <th:block th:each="img, stat : ${book.images}">
                        <input type="radio" 
                               name="carousel" 
                               th:id="'slide' + ${stat.index}"
                               class="carousel-input"
                               th:checked="${stat.index == 0}"
                               th:aria-label="'Slide ' + ${stat.index + 1}">
                    </th:block>
                </th:block>
                
                <div class="carousel">
                    <div class="carousel-slides">
                        <!-- Image Slides -->
                        <th:block th:if="${not #lists.isEmpty(book.images)}">
                            <div th:each="img, stat : ${book.images}" 
                                 class="carousel-slide"
                                 th:aria-hidden="${stat.index != 0}">
                                <img th:src="@{${img.name}}"
                                     th:alt="'Immagine ' + ${stat.index + 1} + ' di ' + ${book.title}"
                                     class="carousel-img"
                                     loading="lazy">
                            </div>
                        </th:block>
                        
                        <!-- Placeholder for no images -->
                        <div th:if="${#lists.isEmpty(book.images)}" 
                             class="carousel-slide placeholder-img">
                            Nessuna immagine disponibile
                        </div>
                    </div>
                    <!-- Navigation Dots -->
                    <div class="carousel-nav" 
                         th:if="${not #lists.isEmpty(book.images) and #lists.size(book.images) > 1}">
                        <label th:each="img, stat : ${book.images}"
                               th:for="'slide' + ${stat.index}"
                               class="carousel-dot"
                               th:aria-label="'Vai alla immagine ' + ${stat.index + 1}">
                        </label>
                    </div>
                </div>
            </div>

            <div class="book-info">
                <h1 class="book-title" th:text="${book.title}">Titolo del Libro</h1>

                <div class="info-section">
                    <h2>Autori</h2>
                    <div class="authors-list">
                        <a th:each="author : ${book.authors}"
                           th:href="@{'/admin/authors/' + ${author.id}}"
                           class="author-link"
                           th:text="${author.name + ' ' + author.surname}">
                            Nome Autore
                        </a>
                    </div>
                </div>

                <div class="info-section">
                    <h2>Anno di Pubblicazione</h2>
                    <p th:text="${book.yearPubblication}">2023</p>
                </div>
				<div class="info-section">
                    <h2>Recensioni</h2>
                    <div class="surveys-list" th:if="${!#lists.isEmpty(book.surveys)}">
                        <div th:each="survey : ${book.surveys}" class="survey-item">
							<h4 class="survey-title" th:text="'Titolo: '+ ${survey.title} + ' [ ' + ${survey.user.name} + ' ' +  ${survey.user.surname}+' ]'">Titolo recensione</h4>
							<p class="survey-text">Testo:</p>
							<p class="survey-text" th:text="${survey.text}">Testo della recensione</p>
							<p class="survey-rating" th:text="${'Valutazione: ' + survey.mark + '/5'}">Valutazione: 5/5</p>
							<form th:action="@{'/admin/books/' + ${book.id} + '/survey/' + ${survey.id} + '/delete'}"
		                          method="post" style="margin-top:0.6em;display:inline;">
		                        <input type="hidden" name="_method" value="delete" />
		                        <button type="submit" class="survey-submit-btn">
		                            Elimina recensione
		                        </button>
		                    </form>
						</div>
                    </div>
					<div class="surveys-list" th:if="${#lists.isEmpty(book.surveys)}">
						<h3 class="survey-empty">Nessuna recensione</h3>
					</div>
                </div>
                </div>
            </div>
        </div>
    </div>

    <footer class="footer">
        <div class="footer-content">
            <p>Siwbooks - La tua libreria digitale</p>
        </div>
    </footer>
</body>
</html>

